{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 17, "column": 0}, "map": {"version":3,"sources":["file:///D:/printx/redmoo/pages/connect-wallet.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport { getWallets } from \"@mysten/wallet-standard\";\r\nimport { useRouter } from \"next/router\";\r\n\r\nfunction Toast({ message, type, onClose }) {\r\n  useEffect(() => {\r\n    if (!message) return;\r\n    const timer = setTimeout(onClose, 3000);\r\n    return () => clearTimeout(timer);\r\n  }, [message, onClose]);\r\n  if (!message) return null;\r\n  return (\r\n    <div className={`fixed top-6 left-1/2 transform -translate-x-1/2 z-50 px-6 py-3 rounded shadow-lg text-white font-bold ${type === \"error\" ? \"bg-red-600\" : \"bg-green-600\"}`}>{message}</div>\r\n  );\r\n}\r\n\r\nexport default function ConnectWallet() {\r\n  const router = useRouter();\r\n  const [wallets, setWallets] = useState([]);\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [selectedWallet, setSelectedWallet] = useState(null);\r\n  const [accounts, setAccounts] = useState([]);\r\n  const [connected, setConnected] = useState(false);\r\n  const [connecting, setConnecting] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  const [toast, setToast] = useState({ message: \"\", type: \"success\" });\r\n  const connectBtnRef = useRef();\r\n\r\n  useEffect(() => {\r\n    setWallets(getWallets().get());\r\n    const unsubscribe = getWallets().on(\"change\", (wallets) => {\r\n      setWallets(wallets);\r\n    });\r\n    return () => unsubscribe();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // If already connected, redirect to profile\r\n    if (typeof window !== 'undefined' && localStorage.getItem('walletConnected') === 'true') {\r\n      router.replace('/profile');\r\n    }\r\n  }, [router]);\r\n\r\n  const handleOpenModal = () => {\r\n    setShowModal(true);\r\n    setSelectedWallet(null);\r\n    setError(\"\");\r\n  };\r\n\r\n  const handleSelectWallet = (wallet) => {\r\n    setSelectedWallet(wallet);\r\n    setError(\"\");\r\n  };\r\n\r\n  const handleConnect = async (e) => {\r\n    e?.preventDefault?.();\r\n    setError(\"\");\r\n    if (!selectedWallet) {\r\n      setError(\"Please select a wallet.\");\r\n      return;\r\n    }\r\n    setConnecting(true);\r\n    try {\r\n      const result = await selectedWallet.features[\"standard:connect\"].connect();\r\n      setAccounts(result.accounts);\r\n      setShowModal(false);\r\n      setToast({ message: `Connected to ${selectedWallet.name}`, type: \"success\" });\r\n      // Save connection state for layout/profile\r\n      localStorage.setItem('walletConnected', 'true');\r\n      if (result.accounts && result.accounts[0]?.address) {\r\n        localStorage.setItem('walletAddress', result.accounts[0].address);\r\n      }\r\n      window.dispatchEvent(new Event('storage'));\r\n      setTimeout(() => router.replace(\"/profile\"), 500);\r\n    } catch (err) {\r\n      setError(\"Failed to connect: \" + (err?.message || err));\r\n      setToast({ message: \"Failed to connect\", type: \"error\" });\r\n    } finally {\r\n      setConnecting(false);\r\n    }\r\n  };\r\n\r\n  // Accessibility: close modal on Escape\r\n  useEffect(() => {\r\n    if (!showModal) return;\r\n    const onKeyDown = (e) => {\r\n      if (e.key === \"Escape\") setShowModal(false);\r\n    };\r\n    window.addEventListener(\"keydown\", onKeyDown);\r\n    return () => window.removeEventListener(\"keydown\", onKeyDown);\r\n  }, [showModal]);\r\n\r\n  return (\r\n    <div className=\"flex items-center justify-center h-full\">\r\n      <Toast message={toast.message} type={toast.type} onClose={() => setToast({ message: \"\", type: \"success\" })} />\r\n      <div className=\"bg-white p-8 rounded-lg shadow-lg text-center w-full max-w-lg\">\r\n        <h1 className=\"text-3xl font-bold text-[#A31D1D] mb-4 font-chonburi\">Connect Your Wallet</h1>\r\n        <p className=\"text-gray-700 font-domine mb-4\">\r\n          Click below to connect your Sui wallet.\r\n        </p>\r\n        <button\r\n          className=\"bg-[#D84040] text-white px-6 py-2 rounded-full hover:bg-[#A31D1D] transition-all duration-200 font-medium font-domine hover:scale-110 transform hover:shadow-lg mb-4\"\r\n          onClick={handleOpenModal}\r\n        >\r\n          Connect Wallet\r\n        </button>\r\n        {error && <div className=\"text-red-600 mb-2\">{error}</div>}\r\n        {/* Modal for wallet selection */}\r\n        {showModal && (\r\n          <div className=\"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50\">\r\n            <div\r\n              className=\"bg-white rounded-lg p-8 max-w-md w-full mx-4 shadow-2xl relative focus:outline-none\"\r\n              tabIndex={-1}\r\n              aria-modal=\"true\"\r\n              role=\"dialog\"\r\n            >\r\n              <button\r\n                className=\"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl\"\r\n                onClick={() => setShowModal(false)}\r\n                aria-label=\"Close\"\r\n              >\r\n                Ã—\r\n              </button>\r\n              <h2 className=\"text-xl font-bold mb-4\">Select Wallet</h2>\r\n              <div className=\"mb-4 flex flex-col items-center\">\r\n                {wallets.length === 0 && (\r\n                  <div className=\"text-gray-500 mb-2 text-center\">\r\n                    No Sui wallets detected.<br />\r\n                    <a href=\"https://suiet.app/\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-[#D84040] underline\">Install Suiet</a> or <a href=\"https://wallet.sui.io/\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-[#D84040] underline\">Sui Wallet</a>\r\n                  </div>\r\n                )}\r\n                {wallets.map((wallet) => (\r\n                  <button\r\n                    key={wallet.name}\r\n                    className={`flex items-center px-4 py-2 mb-2 rounded border w-full justify-center transition-colors focus:outline-none focus:ring-2 focus:ring-[#D84040] ${\r\n                      selectedWallet?.name === wallet.name\r\n                        ? \"border-[#D84040] bg-[#F8F2DE]\"\r\n                        : \"border-gray-200\"\r\n                    }`}\r\n                    onClick={() => handleSelectWallet(wallet)}\r\n                    tabIndex={0}\r\n                    aria-pressed={selectedWallet?.name === wallet.name}\r\n                  >\r\n                    <img\r\n                      src={wallet.icon}\r\n                      alt={wallet.name}\r\n                      className=\"w-6 h-6 mr-2 rounded-full\"\r\n                    />\r\n                    <span className=\"font-domine\">{wallet.name}</span>\r\n                  </button>\r\n                ))}\r\n              </div>\r\n              <button\r\n                className=\"bg-[#D84040] text-white px-6 py-2 rounded-full hover:bg-[#A31D1D] transition-all duration-200 font-medium font-domine hover:scale-110 transform hover:shadow-lg w-full flex items-center justify-center\"\r\n                onClick={handleConnect}\r\n                disabled={!selectedWallet || connecting}\r\n                ref={connectBtnRef}\r\n                aria-busy={connecting}\r\n              >\r\n                {connecting && (\r\n                  <svg className=\"animate-spin h-5 w-5 mr-2 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\"><circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle><path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8v8z\"></path></svg>\r\n                )}\r\n                Connect\r\n              </button>\r\n              {error && <div className=\"text-red-600 mt-2\">{error}</div>}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n      <style jsx>{`\r\n        @media (max-width: 600px) {\r\n          .max-w-lg, .max-w-md { max-width: 98vw !important; }\r\n          .p-8 { padding: 1.5rem !important; }\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}